name: Executar Scraper Diario

on:
  workflow_dispatch: # Bot√£o manual para rodar

jobs:
  build:
    runs-on: ubuntu-latest
    permissions:
      contents: write
    steps:
      - name: Baixar codigo
        uses: actions/checkout@v3

      - name: Instalar Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.9'

      - name: Instalar Bibliotecas
        run: pip install selenium webdriver-manager

      - name: Rodar o Scraper
        # Aqui enviamos a URL e dizemos para salvar com o nome que o GitHub espera
        run: |
          python script.py "https://www.doctoralia.com.br/endocrinologista/unimed" --limite 50 --headless --output resultado_doctoralia.csv

      - name: Salvar no Repositorio
        run: |
          git config --global user.name "GitHub Actions Bot"
          git config --global user.email "actions@github.com"
          if [ -f resultado_doctoralia.csv ]; then
            git add resultado_doctoralia.csv
            git commit -m "Planilha atualizada via Scraper"
            git push
          else
            echo "Erro: O arquivo resultado_doctoralia.csv nao foi encontrado."
            exit 1
          fi
